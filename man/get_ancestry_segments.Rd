% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ancestry_segments.R
\name{get_ancestry_segments}
\alias{get_ancestry_segments}
\title{Extract Ancestry Segments from Bin Data}
\usage{
get_ancestry_segments(
  bed_data,
  chrom_order = paste0("chr", 1:10),
  report = FALSE
)
}
\arguments{
\item{bed_data}{Data frame or data.table with columns: sample, chrom, start, end, genotype}

\item{chrom_order}{Character vector. Chromosome names in desired order
(default: paste0("chr", 1:10))}

\item{report}{Logical. Whether to print progress reports (default: FALSE)}
}
\value{
Data.table with columns:
\item{sample}{Sample identifier}
\item{chrom}{Chromosome name}
\item{start}{Segment start position}
\item{end}{Segment end position}
\item{genotype}{Segment genotype (REF, HET, or ALT)}
\item{score}{Mean score if available}
\item{alt_freq}{Mean alternative allele frequency if available}
}
\description{
Main function to find connected components and extract ancestry segments
for all genotype states (REF, HET, ALT) across samples and chromosomes.
}
\details{
This function processes genomic bins to identify contiguous segments
of the same ancestry state. Uses run-length encoding to efficiently
find connected components within each sample-chromosome combination.
}
\examples{
# Create example bin data
bin_data <- data.frame(
  sample = rep("sample1", 5),
  chrom = rep("chr1", 5),
  start = c(1, 1000000, 2000000, 3000000, 4000000),
  end = c(999999, 1999999, 2999999, 3999999, 4999999),
  genotype = c("REF", "ALT", "ALT", "REF", "REF")
)

segments <- get_ancestry_segments(bin_data)
print(segments)

}
