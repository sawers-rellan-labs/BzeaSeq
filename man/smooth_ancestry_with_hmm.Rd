% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hmm.R
\name{smooth_ancestry_with_hmm}
\alias{smooth_ancestry_with_hmm}
\title{Apply HMM Smoothing to Ancestry Calls}
\usage{
smooth_ancestry_with_hmm(genotypes, transitions = c(0.995, 0.005))
}
\arguments{
\item{genotypes}{Character vector or factor. Ancestry calls with levels
c("REF", "HET", "ALT")}

\item{transitions}{Numeric vector of length 2. Transition probabilities
where transitions\link{1} = P(stay in same state) and transitions\link{2} = P(switch states)
(default: c(0.995, 0.005))}
}
\value{
Factor with smoothed ancestry calls (levels: REF, HET, ALT)
}
\description{
Applies Hidden Markov Model smoothing to noisy ancestry classifications
to enforce biological constraints and reduce classification errors.
}
\details{
The HMM uses:
\itemize{
\item Start probabilities from BC2S3 breeding expectations
\item High self-transition probabilities to model genomic linkage
\item Emission probabilities that account for classification uncertainty
}

The default transition probabilities (0.995 stay, 0.005 switch) assume
approximately 1 Mb bins and 1 cM/Mb recombination rate.
}
\examples{
\dontrun{
# Simulate noisy ancestry calls
noisy_calls <- factor(c("REF", "ALT", "REF", "REF", "HET", "REF"), 
                      levels = c("REF", "HET", "ALT"))

# Apply smoothing
smoothed <- smooth_ancestry_with_hmm(noisy_calls)
print(data.frame(original = noisy_calls, smoothed = smoothed))
}

}
