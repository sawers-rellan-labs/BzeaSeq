% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/introgression_plots.R
\name{add_segment_metadata}
\alias{add_segment_metadata}
\title{Add Segment Metadata and Snap to Bin Boundaries}
\usage{
add_segment_metadata(data, bin_size = 1e+06)
}
\arguments{
\item{data}{Data frame with segment data}

\item{bin_size}{Integer. Size of genomic bins in base pairs (default: 1000000)}
}
\value{
Data frame with additional columns:
\item{segment_id}{Sequential segment identifier within each sample-chromosome}
\item{bin_start}{Segment start snapped to bin boundary}
\item{bin_end}{Segment end snapped to bin boundary (not exceeding chromosome length)}
\item{span}{Updated span based on bin boundaries}
\item{largest_introgression_midpoint}{Position of largest introgression block}
}
\description{
Adds segment identifiers and snaps coordinates to bin boundaries for
consistent visualization and analysis.
}
\details{
Ensures all segments align to standard bin boundaries for consistent
analysis and visualization. Prevents bin coordinates from exceeding
known chromosome lengths.
}
\examples{
\dontrun{
segment_data <- data.frame(
  sample = "sample1",
  chrom = "chr1", 
  start = 1500000,
  end = 2300000,
  genotype = "ALT"
)

result <- add_segment_metadata(segment_data, bin_size = 1000000)
print(result)
}

}
